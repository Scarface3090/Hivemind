# Test Plan: Flow 1 - Hosting a New Game

**Objective:** To verify that a user can successfully and completely host a new game as described in "Flow 1" of the `Hivemind_GDD.md`.

**Prerequisites:**
- The application must be running in the Devvit playtest environment (`npx devvit playtest`).
- The user must be authenticated within the Reddit environment.
- The backend services, including Redis, must be operational.

---

## Test Cases

### 1. Happy Path & Core Functionality

| Test Case ID | Description                                                                                                                              | Steps                                                                                                                                                                                                                                                                                       | Expected Result                                                                                                                                                                                                                                                                  | Status  |
| :----------- | :--------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------ |
| **TC1.1**    | **Successful Game Creation:** A user can navigate to the host screen, fill out the form, and successfully publish a new game.             | 1. From the `HomeScreen`, click "Host Game".<br>2. On the `HostView`, observe that a spectrum (e.g., "Bad Movie" to "Good Movie") is displayed.<br>3. Enter a valid `clue` (e.g., "A cinematic masterpiece").<br>4. Select a valid `duration` from the dropdown (e.g., "1 hour").<br>5. Click "Start Game". | 1. The user is navigated back to the `HomeScreen`.<br>2. A success notification/toast appears briefly.<br>3. The newly created game should appear in the "Join Game" feed (either on the `HomeScreen` or `GameFeed` view), showing the correct `clue` and remaining time. | Pending |

---

### 2. UI/UX Validation

| Test Case ID | Description                                                                                                  | Steps                                                                                                   | Expected Result                                                                                                                                                                                                   | Status  |
| :----------- | :----------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------ |
| **TC2.1**    | **Host View UI Elements:** Verify that all required UI components are present and correctly displayed.       | 1. Navigate to the `HostView`.                                                                          | 1. The view must display:<br>    - The fetched `spectrum` with its left and right labels.<br>    - A text input area for the `clue`.<br>    - A dropdown or selection input for the `duration`.<br>    - A "Start Game" button. | Pending |
| **TC2.2**    | **Loading State:** Verify that a loading indicator is shown while the system is fetching the game draft.     | 1. Navigate to the `HostView`.<br>2. (If possible, throttle network speed to observe the loading state). | A loading spinner or skeleton screen should be visible while the draft `spectrum` is being fetched from the backend. The form should be disabled during this time.                                                   | Pending |
| **TC2.3**    | **Submission State:** Verify that the "Start Game" button is disabled after being clicked to prevent multiple submissions. | 1. On the `HostView`, fill in all required fields.<br>2. Click "Start Game".                               | The "Start Game" button should become disabled and possibly show a loading indicator until the request is complete.                                                                                             | Pending |

---

### 3. Input Validation and Error Handling

| Test Case ID | Description                                                                           | Steps                                                                                                                      | Expected Result                                                                                                                                                                       | Status  |
| :----------- | :------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :------ |
| **TC3.1**    | **Empty Clue Submission:** Attempt to start a game with an empty `clue`.              | 1. Navigate to the `HostView`.<br>2. Select a `duration`.<br>3. Leave the `clue` field empty.<br>4. Click "Start Game".     | 1. The submission should fail.<br>2. A validation message (e.g., "Clue cannot be empty") should be displayed near the text input.<br>3. The user should remain on the `HostView`. | Pending |
| **TC3.2**    | **No Duration Selected:** Attempt to start a game without selecting a `duration`.     | 1. Navigate to the `HostView`.<br>2. Enter a `clue`.<br>3. Do not select a `duration`.<br>4. Click "Start Game".         | 1. The submission should fail.<br>2. A validation message should be displayed near the duration selector.<br>3. The user should remain on the `HostView`.                             | Pending |
| **TC3.3**    | **API Error on Publish:** Simulate a backend error during game publication.             | 1. Use browser dev tools to manually force the `POST /api/games` endpoint to return a 500 error.<br>2. Submit the form. | 1. An error message/toast should be displayed to the user (e.g., "Failed to create game. Please try again.").<br>2. The user should remain on the `HostView`, and the form should be re-enabled. | Pending |

---

### 4. Backend and Data Verification

| Test Case ID | Description                                                                                  | Steps                                                                                                                                        | Expected Result                                                                                                                                                                                                                                                                                                                                                                                                       | Status  |
| :----------- | :------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------ |
| **TC4.1**    | **Draft Creation:** Verify that a draft is correctly created when the user enters the `HostView`. | 1. Navigate to the `HostView`.<br>2. Inspect network traffic in browser dev tools.                                                          | A `POST` request to `/api/games/draft` should be sent automatically. The response should contain a `draftId` and a `spectrum` object.                                                                                                                                                                                                                                                                             | Pending |
| **TC4.2**    | **Game Publication Payload:** Verify that the correct data is sent when publishing a game.    | 1. On the `HostView`, fill out the form.<br>2. Before submitting, open browser dev tools.<br>3. Click "Start Game" and inspect the request. | A `POST` request to `/api/games` should be sent. The request payload must contain the correct `draftId`, `clue`, and `duration`.                                                                                                                                                                                                                                                                                        | Pending |
| **TC4.3**    | **Redis State:** Verify that the game data is correctly stored in Redis after publication.    | 1. Successfully publish a new game (from TC1.1).<br>2. Connect to the Redis instance and inspect the relevant keys.                       | 1. A new game entry with a unique ID should be created.<br>2. The game data should correctly store the `hostId`, `clue`, `duration`, `spectrum`, `secretTarget`, and have a state of `ACTIVE`.<br>3. An entry for the game's expiration should be added to the scheduler's sorted set. | Pending |
